<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Konsultasi, Saran & Feedback - PKA BKPSDM</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <style>
      /* CSS tetap sama seperti sebelumnya */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: Arial, sans-serif;
      }
      body {
        background-color: #f5f5f5;
        color: #333;
      }
      .header-container {
        background: linear-gradient(90deg, #6a11cb 0%, #8e2de2 100%);
        color: white;
        padding: 15px 20px;
        display: flex;
        flex-direction: column;
      }
      .header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .logo-container {
        display: flex;
        align-items: center;
      }
      .logo-container img {
        height: 50px;
        margin-right: 10px;
      }
      .site-title {
        font-size: 20px;
        font-weight: bold;
      }
      .nav-menu {
        list-style: none;
        display: flex;
        gap: 20px;
      }
      .nav-menu a {
        color: white;
        text-decoration: none;
        font-weight: bold;
      }
      .nav-menu a:hover {
        text-decoration: underline;
      }
      .header-right {
        display: flex;
        align-items: center;
        gap: 15px;
      }
      .search-container {
        display: flex;
        align-items: center;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        padding: 5px 12px;
      }
      .search-container input {
        background: transparent;
        border: none;
        color: white;
        padding: 5px;
        width: 180px;
        outline: none;
      }
      .search-container input::placeholder {
        color: rgba(255, 255, 255, 0.7);
      }
      .search-container button {
        background: transparent;
        border: none;
        color: white;
        cursor: pointer;
      }
      .user-info {
        display: flex;
        align-items: center;
        gap: 8px;
        background: rgba(255, 255, 255, 0.2);
        padding: 6px 12px;
        border-radius: 20px;
      }
      .user-info i {
        font-size: 16px;
      }
      .help-link {
        background: #ff6b6b;
        padding: 6px 12px;
        border-radius: 5px;
        font-weight: bold;
        cursor: pointer;
      }

     /* KSF Styles */
.ksf-container {
  max-width: 1200px;
  margin: 30px auto;
  padding: 0 20px;
}

.ksf-header {
  text-align: center;
  margin-bottom: 30px;
}

.ksf-header h1 {
  font-size: 32px;
  color: #6a11cb;
  margin-bottom: 10px;
}

.ksf-header p {
  color: #666;
  font-size: 18px;
}

.ksf-tabs {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-bottom: 40px;
}

.ksf-tab {
  padding: 15px 30px;
  background: white;
  border: 2px solid #6a11cb;
  border-radius: 50px;
  font-size: 18px;
  font-weight: bold;
  color: #6a11cb;
  cursor: pointer;
  transition: all 0.3s ease;
}

.ksf-tab.active {
  background: #6a11cb;
  color: white;
}

.ksf-tab:hover:not(.active) {
  background: #f0f0ff;
}

.ksf-content {
  background: white;
  border-radius: 10px;
  padding: 30px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  min-height: 400px;
  transition: opacity 0.3s ease;
}

.ksf-form {
  display: none;
  animation: fadeIn 0.5s ease;
}

.ksf-form.active {
  display: block;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 500;
  color: #333;
}

.form-group input,
.form-group textarea,
.form-group select {
  width: 100%;
  padding: 12px 15px;
  border: 1px solid #ddd;
  border-radius: 5px;
  font-size: 14px;
  transition: border-color 0.3s;
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
  border-color: #6a11cb;
  outline: none;
  box-shadow: 0 0 0 2px rgba(106, 17, 203, 0.2);
}

.form-group textarea {
  min-height: 150px;
  resize: vertical;
}

.hidden {
  display: none;
}

.submit-button {
  width: 100%;
  padding: 12px;
  background: linear-gradient(135deg, #6a11cb, #8e2de2);
  border: none;
  border-radius: 5px;
  color: white;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.3s, box-shadow 0.3s;
}

.submit-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(106, 17, 203, 0.4);
}

.submit-button:disabled {
  background: #ccc;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}
      .login-prompt {
        text-align: center;
        padding: 40px;
        background: #f9f9f9;
        border-radius: 10px;
        margin-top: 20px;
      }
      .login-prompt h3 {
        color: #6a11cb;
        margin-bottom: 15px;
      }
      .login-prompt p {
        margin-bottom: 20px;
        color: #666;
      }
      .login-btn {
        display: inline-block;
        background: #6a11cb;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        text-decoration: none;
        font-weight: bold;
        transition: background 0.3s;
      }
      .login-btn:hover {
        background: #5a0db5;
      }
      .success-message {
        background: #d4edda;
        color: #155724;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
        display: none;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      footer {
        background: linear-gradient(135deg, #4a148c 0%, #6a11cb 100%);
        color: white;
        padding: 30px 20px 15px;
        margin-top: 50px;
      }
      .footer-container {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
        max-width: 1200px;
        margin: 0 auto;
        gap: 30px;
      }
      .footer-contact .address {
  display: flex;
  align-items: flex-start;
  gap: 10px;
}

.footer-contact .address i {
  font-size: 24px;
  color: #ffffff; /* ubah sesuai warna tema */
  margin-top: 4px;
}
      .footer-links ul {
        list-style: none;
      }
      .footer-links a {
        color: white;
        text-decoration: none;
      }
      .footer-links a:hover {
        text-decoration: underline;
      }
    .footer-logos {
  padding: 20px 0;
  text-align: center;
}

.logo-container {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 15px;
  flex-wrap: wrap;
}

.logo-container img {
  height: 50px; /* ðŸ”Ž diperkecil dari sebelumnya */
  width: auto;
  transition: transform 0.3s ease;
}

.logo-container img:hover {
  transform: scale(1.05);
}

@media (max-width: 768px) {
  .logo-container {
    gap: 20px;
  }
  .logo-container img {
    height: 40px; /* lebih kecil di tablet */
  }
}

@media (max-width: 480px) {
  .logo-container {
    gap: 15px;
  }
  .logo-container img {
    height: 35px; /* lebih kecil di HP */
  }
}

      .footer-copyright {
        text-align: center;
        margin-top: 20px;
        font-size: 14px;
        opacity: 0.8;
      }
      @media (max-width: 900px) {
        .ksf-tabs {
          flex-direction: column;
          align-items: center;
        }
        .ksf-tab {
          width: 100%;
          max-width: 300px;
          text-align: center;
        }
        .header-top {
          flex-direction: column;
          gap: 15px;
        }
        .nav-menu {
          flex-wrap: wrap;
          justify-content: center;
        }
        .header-right {
          flex-wrap: wrap;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <header class="header-container">
      <div class="header-top">
        <div class="logo-container">
          <img
            src="https://i.ibb.co.com/JWw8qHmM/logo-bkpsdm.png"
            alt="Logo BKPSDM"
          />
          <div class="site-title">PKA BKPSDM</div>
        </div>
        <nav>
          <ul class="nav-menu">
            <li><a href="home.html">HOME</a></li>
           <li><a href="ksf.html">KONSULTASI, SARAN, FEEDBACK</a></li>
            <li><a href="informasi.html">INFORMASI</a></li>
           
          </ul>
        </nav>
        <div class="header-right">
          <div class="search-container">
            <input type="text" placeholder="Cari informasi..." />
            <button><i class="fas fa-search"></i></button>
          </div>
          <div class="user-info">
            <i class="fas fa-user"></i><span id="user-display">Guest</span>
          </div>
         
        </div>
      </div>
    </header>

    <div class="ksf-container">
      <div class="ksf-header">
        <h1>Konsultasi, Saran & Feedback</h1>
        <p>Berikan masukan Anda untuk pengembangan kompetensi aparatur</p>
      </div>

      <div class="ksf-tabs">
        <div class="ksf-tab active" data-tab="konsultasi">Konsultasi</div>
        <div class="ksf-tab" data-tab="saran">Saran</div>
        <div class="ksf-tab" data-tab="feedback">Feedback</div>
      </div>

      <div class="ksf-content">
        <!-- Login Prompt (default for guests) -->
        <div id="login-prompt" class="login-prompt">
          <h3>Anda perlu login untuk mengakses layanan ini</h3>
          <p>
            Silakan login terlebih dahulu untuk memberikan konsultasi, saran,
            atau feedback.
          </p>
          <a href="login.html" class="login-btn">Login Sekarang</a>
        </div>

        <!-- Success Message -->
        <div id="success-message" class="success-message">
          <i class="fas fa-check-circle"></i>
          <span id="success-text"
            >Terima kasih! Masukan Anda telah berhasil dikirim.</span
          >
        </div>

      <form id="konsultasi-form" class="ksf-form active">
  <!-- 1. Topik Konsultasi -->
  <div class="form-group">
    <label for="konsultasi-topik">Topik Konsultasi</label>
    <select id="konsultasi-topik" name="topik" required>
      <option value="">Pilih topik konsultasi</option>
      <option value="pengembangan-kompetensi">Pengembangan Kompetensi</option>
      <option value="pelatihan">Pelatihan dan Diklat</option>
      <option value="karier">Seminar dan Webinar</option>
      <option value="lainnya">Lainnya</option>
    </select>
  </div>

  <div class="form-group hidden" id="topik-lainnya-group">
    <label for="topik-lainnya">Sebutkan topik lainnya</label>
    <input
      type="text"
      id="topik-lainnya"
      name="topik_lainnya"
      placeholder="Tuliskan topik konsultasi lain..."
    />
  </div>

  <!-- 2. Alasan Kebutuhan Pelatihan -->
  <div class="form-group">
    <label for="alasan-pelatihan">Alasan Kebutuhan Pelatihan</label>
    <select id="alasan-pelatihan" name="alasan_pelatihan" required>
      <option value="">Pilih alasan</option>
      <option value="jabatan-baru">Tuntutan Jabatan Baru</option>
      <option value="perubahan-regulasi">Perubahan Regulasi</option>
      <option value="teknologi">Perubahan Teknologi</option>
      <option value="lainnya">Lainnya</option>
    </select>
  </div>

  <div class="form-group hidden" id="alasan-lainnya-group">
    <label for="alasan-lainnya">Sebutkan alasan lainnya</label>
    <input
      type="text"
      id="alasan-lainnya"
      name="alasan_lainnya"
      placeholder="Tuliskan alasan lain..."
    />
  </div>

  <!-- 3. Metode Pelatihan -->
  <div class="form-group">
    <label for="metode-pelatihan">Metode Pelatihan yang Diinginkan</label>
    <select id="metode-pelatihan" name="metode_pelatihan" required>
      <option value="">Pilih metode</option>
      <option value="tatap-muka">Tatap Muka Kelas</option>
      <option value="workshop">Workshop / Praktik Lapangan</option>
      <option value="elearning">E-learning / Daring</option>
      <option value="coaching">Coaching / Mentoring</option>
      <option value="lainnya">Lainnya</option>
    </select>
  </div>

  <div class="form-group hidden" id="metode-lainnya-group">
    <label for="metode-lainnya">Sebutkan metode lainnya</label>
    <input
      type="text"
      id="metode-lainnya"
      name="metode_lainnya"
      placeholder="Tuliskan metode pelatihan lain..."
    />
  </div>

  <!-- 4. Prioritas Waktu -->
  <div class="form-group">
    <label for="prioritas-waktu">Prioritas Waktu Pelaksanaan</label>
    <select id="prioritas-waktu" name="prioritas_waktu" required>
      <option value="">Pilih waktu</option>
      <option value="0-3">0 - 3 Bulan</option>
      <option value="3-6">3 - 6 Bulan</option>
      <option value=">6">Lebih dari 6 Bulan</option>
    </select>
  </div>

  <!-- 5. Dukungan dari Instansi -->
  <div class="form-group">
    <label for="dukungan-instansi">Dukungan yang Dibutuhkan dari Instansi</label>
    <select id="dukungan-instansi" name="dukungan_instansi" required>
      <option value="">Pilih dukungan</option>
      <option value="pendanaan">Pendanaan</option>
      <option value="waktu">Waktu / Izin Belajar</option>
      <option value="fasilitas">Fasilitas / Sarana</option>
      <option value="lainnya">Lainnya</option>
    </select>
  </div>

  <div class="form-group hidden" id="dukungan-lainnya-group">
    <label for="dukungan-lainnya">Sebutkan dukungan lainnya</label>
    <input
      type="text"
      id="dukungan-lainnya"
      name="dukungan_lainnya"
      placeholder="Tuliskan dukungan lain..."
    />
  </div>

  <!-- Pertanyaan atau Permasalahan -->
  <div class="form-group">
    <label for="konsultasi-pesan">Pertanyaan atau Permasalahan</label>
    <textarea
      id="konsultasi-pesan"
      name="pesan"
      placeholder="Jelaskan pertanyaan atau permasalahan yang ingin dikonsultasikan"
      required
    ></textarea>
  </div>

  <!-- Tingkat Prioritas -->
  <div class="form-group">
    <label for="konsultasi-prioritas">Tingkat Prioritas</label>
    <select id="konsultasi-prioritas" name="prioritas" required>
      <option value="">Pilih tingkat prioritas</option>
      <option value="rendah">Rendah</option>
      <option value="sedang">Sedang</option>
      <option value="tinggi">Tinggi</option>
    </select>
  </div>

  <button type="submit" class="submit-button">Kirim Konsultasi</button>
</form>

        <!-- Saran Form -->
        <form id="saran-form" class="ksf-form">
          <div class="form-group">
            <label for="saran-jenis">Jenis Saran</label>
            <select id="saran-jenis" name="jenis" required>
              <option value="">Pilih jenis saran</option>
              <option value="program-pelatihan">Program Pelatihan</option>
              <option value="metode-pembelajaran">Metode Pembelajaran</option>
              <option value="fasilitas">Fasilitas</option>
              <option value="lainnya">Lainnya</option>
            </select>
          </div>
          <div class="form-group">
            <label for="saran-pesan">Saran Anda</label>
            <textarea
              id="saran-pesan"
              name="pesan"
              placeholder="Tuliskan saran Anda untuk pengembangan kompetensi aparatur"
              required
            ></textarea>
          </div>
          <div class="form-group">
            <label for="saran-tujuan">Tujuan Saran</label>
            <input
              type="text"
              id="saran-tujuan"
              name="tujuan"
              placeholder="Tujuan atau manfaat dari saran ini"
              required
            />
          </div>
          <button type="submit" class="submit-button">Kirim Saran</button>
        </form>

        <!-- Feedback Form -->
        <form id="feedback-form" class="ksf-form">
          <div class="form-group">
            <label for="feedback-topik">Topik Feedback</label>
            <select id="feedback-topik" name="topik" required>
              <option value="">Pilih topik feedback</option>
              <option value="program-pelatihan">Program Pelatihan</option>
              <option value="fasilitator">Fasilitator/Pemateri</option>
              <option value="materi">Materi Pelatihan</option>
              <option value="fasilitas">Fasilitas</option>
              <option value="lainnya">Lainnya</option>
            </select>
          </div>
          <div class="form-group">
            <label for="feedback-pesan">Feedback Anda</label>
            <textarea
              id="feedback-pesan"
              name="pesan"
              placeholder="Berikan feedback mengenai pengalaman Anda"
              required
            ></textarea>
          </div>
          <div class="form-group">
            <label for="feedback-rating">Rating (1-5)</label>
            <select id="feedback-rating" name="rating" required>
              <option value="">Pilih rating</option>
              <option value="1">1 - Sangat Buruk</option>
              <option value="2">2 - Buruk</option>
              <option value="3">3 - Cukup</option>
              <option value="4">4 - Baik</option>
              <option value="5">5 - Sangat Baik</option>
            </select>
          </div>
          <button type="submit" class="submit-button">Kirim Feedback</button>
        </form>
      </div>
    </div>

    <footer>
      <div class="footer-container">
        <div class="footer-contact">
  <h4>BKPSDM Ciamis</h4>
  <div class="address">
    <a href="https://maps.app.goo.gl/EWDwFJ5zFucuVRFv7" target="_blank">
      <i class="fa-solid fa-map-location-dot"></i>
    </a>
    <div>
      <p>Jl. Sadananya No. 27</p>
      <p>Kelurahan Maleber</p>
      <p>Kecamatan Ciamis</p>
    </div>
  </div>
</div>

        <div class="footer-links">
          <h4>Link Terkait</h4>
          <ul>
            <li><a href="https://bkpsdm.ciamiskab.go.id/">BKPSDM Kabupaten Ciamis</a></li>
            <li><a href="https://sibangpeci.ciamiskab.go.id/">Si Bang Peci</a></li>
          </ul>
        </div>
       <div class="footer-logos">
  <div class="logo-container">
    <img src="https://i.ibb.co.com/tMnbFSr5/Lambang-Kabupaten-Ciamis.png" alt="Lambang Kabupaten Ciamis" />
    <img src="https://i.ibb.co.com/JWw8qHmM/logo-bkpsdm.png" alt="Logo BKPSDM Kabupaten Ciamis" />
    <img src="https://i.ibb.co.com/6JvSKyNf/Logo-Ber-AKHLAK-svg.png" alt="Logo BerAKHLAK" />
    <img src="https://i.ibb.co.com/99NKJGNg/bangga.png" alt="Bangga Melayani Bangsa" />
  </div>
</div>

      </div>
      <div class="footer-copyright">
        <p>Copyright Â© 2025 PKA BKPSDM Ciamis | All Rights Reserved, v1.0</p>
      </div>
    </footer>

    <script>
      // ** Ganti URL di bawah dengan URL Google Apps Script Anda setelah dipublikasikan. **
      const scriptUrl =
        "https://script.google.com/macros/s/AKfycbyMnYcysMHj3tolv8bvsJh7Z-8tg0wmtlHL01ozRjqiHGeiHn8a4f3SnfCA5qkiEfRG/exec";

      // Check login status
      function checkLoginStatus() {
        const userDisplay = document.getElementById("user-display");
        const loginPrompt = document.getElementById("login-prompt");
        const forms = document.querySelectorAll(".ksf-form");
        const loginData = localStorage.getItem("loginData");

        if (loginData) {
          const userData = JSON.parse(loginData);
          userDisplay.textContent = userData.name;
          loginPrompt.style.display = "none";
          forms.forEach((form) => (form.style.display = "none"));

          const activeForm = document.querySelector(".ksf-form.active");
          if (activeForm) {
            activeForm.style.display = "block";
          }
        } else {
          userDisplay.textContent = "Guest";
          loginPrompt.style.display = "block";
          forms.forEach((form) => (form.style.display = "none"));
        }
      }

      // Tab switching functionality
      function setupTabs() {
        const tabs = document.querySelectorAll(".ksf-tab");
        const forms = document.querySelectorAll(".ksf-form");

        tabs.forEach((tab) => {
          tab.addEventListener("click", function () {
            tabs.forEach((t) => t.classList.remove("active"));
            this.classList.add("active");

            forms.forEach((form) => {
              form.classList.remove("active");
              form.style.display = "none";
            });

            const tabId = this.getAttribute("data-tab");
            const activeForm = document.getElementById(`${tabId}-form`);
            if (activeForm) {
              activeForm.classList.add("active");

              const loginData = localStorage.getItem("loginData");
              if (loginData) {
                activeForm.style.display = "block";
              }
            }
          });
        });
      }

// Fungsi untuk toggle field "lainnya" secara otomatis
  function toggleLainnya(selectId, groupId, inputId) {
    document.getElementById(selectId).addEventListener("change", function () {
      const group = document.getElementById(groupId);
      const input = document.getElementById(inputId);
      if (this.value === "lainnya") {
        group.classList.remove("hidden");
        input.setAttribute("required", "required");
      } else {
        group.classList.add("hidden");
        input.removeAttribute("required");
        input.value = "";
      }
    });
  }

  // Terapkan ke semua select yang punya opsi "Lainnya"
  toggleLainnya("konsultasi-topik", "topik-lainnya-group", "topik-lainnya");
  toggleLainnya("alasan-pelatihan", "alasan-lainnya-group", "alasan-lainnya");
  toggleLainnya("metode-pelatihan", "metode-lainnya-group", "metode-lainnya");
  toggleLainnya("dukungan-instansi", "dukungan-lainnya-group", "dukungan-lainnya");
      
      // Form submission - PERBAIKAN: Kirim name dan username
      function setupFormSubmission() {
        const forms = document.querySelectorAll(".ksf-form");
        const successMessage = document.getElementById("success-message");
        const successText = document.getElementById("success-text");

        forms.forEach((form) => {
          form.addEventListener("submit", async function (e) {
            e.preventDefault();

            const loginData = localStorage.getItem("loginData");
            if (!loginData) {
              alert("Anda perlu login untuk mengirimkan masukan.");
              window.location.href = "login.html";
              return;
            }

            const userData = JSON.parse(loginData);
            const formData = new FormData(this);
            const data = {
              action: "ksf_submission",
              type: this.id.replace("-form", ""),
              name: userData.name, // Nama lengkap
              username: userData.username, // Username (NIP)
              timestamp: new Date().toISOString(),
            };

            // Add form data to submission
            for (let [key, value] of formData.entries()) {
              data[key] = value;
            }

            try {
              const response = await fetch(scriptUrl, {
                method: "POST",
                body: JSON.stringify(data),
              });

              if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
              }

              const result = await response.json();
              if (result.status === "success") {
                successText.textContent = `Terima kasih! ${
                  this.id.replace("-form", "").charAt(0).toUpperCase() +
                  this.id.replace("-form", "").slice(1)
                } Anda telah berhasil dikirim.`;
                successMessage.style.display = "block";

                this.reset();

                setTimeout(() => {
                  successMessage.style.display = "none";
                }, 5000);
              } else {
                alert(
                  "Terjadi kesalahan saat mengirim data: " + result.message
                );
              }
            } catch (error) {
              alert("Terjadi kesalahan: " + error.message);
              console.error("Error:", error);
            }
          });
        });
      }

      // Initialize page
      document.addEventListener("DOMContentLoaded", function () {
        checkLoginStatus();
        setupTabs();
        setupFormSubmission();

        // Pastikan form konsultasi aktif saat pertama kali load
        const loginData = localStorage.getItem("loginData");
        if (loginData) {
          const konsultasiForm = document.getElementById("konsultasi-form");
          if (konsultasiForm) {
            konsultasiForm.classList.add("active");
            konsultasiForm.style.display = "block";
          }
        }
      });

      // Fungsi untuk testing
      function testLogin() {
        const testUser = {
          name: "Dr. Ahmad Wijaya, M.Si.",
          username: "196512101987031001",
          loginTime: new Date().toISOString(),
        };
        localStorage.setItem("loginData", JSON.stringify(testUser));
        checkLoginStatus();
        alert(
          "Test login berhasil! Form seharusnya muncul sekarang.\nNama: " +
            testUser.name +
            "\nNIP: " +
            testUser.username
        );
      }
    </script>
  </body>
</html>







